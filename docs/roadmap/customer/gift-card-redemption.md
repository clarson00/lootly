# Gift Card / Certificate Redemption

> **Status:** ðŸ“‹ Planned
> **Priority:** Medium - High perceived value rewards
> **Entitlement:** Pro tier or Gift Cards Add-on

---

## Dependencies

- **Requires:**
  - **Reward Monetary Values** (CRITICAL - need to calculate card worth)
  - Rewards system (existing)
  - Email/SMS delivery infrastructure

- **Enables:**
  - Cash-equivalent rewards
  - Higher perceived value
  - Gift-giving between customers
  - Cross-business rewards (platform gift cards)

---

## Roadmap Position

- **Tier:** 4 (Gamification)
- **Phase:** v2.0
- **Category:** Customer + Tenant

---

## Cross-References

- Related specs:
  - [Reward Monetary Values](../platform/reward-monetary-values.md) - **BLOCKER**
  - [Physical Rewards](./physical-rewards.md)
  - [Referrals](./referrals.md)

---

## Overview

Allow customers to redeem their loyalty points for digital gift cards or certificates that can be used at the business. Higher perceived value than percentage discounts.

---

## Why Gift Cards?

### Customer Psychology

| Reward Type | Perceived Value | Actual Cost |
|-------------|-----------------|-------------|
| "10% off" | Low | Variable |
| "Free appetizer" | Medium | ~$8 |
| "$10 Gift Card" | **High** | $10 |

Gift cards feel like **real money**. They're:
- Tangible (even digitally)
- Giftable to friends/family
- Clearly valued
- Exciting to earn

### Business Benefits

- Clear cost structure (know exactly what you're giving)
- Drives return visits (must come back to use)
- Often results in overspend (customer spends more than card value)
- Can be gifted â†’ new customer acquisition

---

## Gift Card Types

### 1. Digital Store Gift Card

Generated by the business, redeemable in-store.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚         ðŸŽ TONY'S RESTAURANT GIFT CARD                     â”‚
â”‚                                                             â”‚
â”‚                      $10.00                                â”‚
â”‚                                                             â”‚
â”‚         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                       â”‚
â”‚         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                       â”‚
â”‚                  [QR CODE]                                 â”‚
â”‚         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                       â”‚
â”‚         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                       â”‚
â”‚                                                             â”‚
â”‚         Code: TONY-A3F7-X9K2                               â”‚
â”‚         Earned by: Sarah M.                                â”‚
â”‚         Valid until: March 30, 2025                        â”‚
â”‚                                                             â”‚
â”‚         [Add to Apple Wallet]  [Add to Google Pay]         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. E-Gift Card (Giftable)

Customer earns and can send to someone else.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸŽ You've earned a $10 Gift Card!                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ What would you like to do?                                 â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚                   â”‚  â”‚                   â”‚              â”‚
â”‚ â”‚   Keep for        â”‚  â”‚   Gift to a       â”‚              â”‚
â”‚ â”‚   Myself          â”‚  â”‚   Friend          â”‚              â”‚
â”‚ â”‚                   â”‚  â”‚                   â”‚              â”‚
â”‚ â”‚   [Use Now]       â”‚  â”‚   [Send Gift]     â”‚              â”‚
â”‚ â”‚                   â”‚  â”‚                   â”‚              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Platform Gift Card (Future)

Redeemable at any Rewards Pirate business.

---

## Redemption Flow

### Customer Earns Gift Card

```
1. Customer has 1,000 doubloons
2. Browses rewards â†’ sees "$10 Gift Card" for 1,000 pts
3. Taps "Redeem"
4. Confirms redemption
5. Gift card generated instantly
6. Delivered via:
   - In-app (saved to wallet)
   - Email (PDF attachment)
   - SMS (link to view)
7. Points deducted from balance
```

### Customer Uses Gift Card

**In-Store:**
```
1. Customer at checkout: "I have a gift card"
2. Shows QR code or gives code to staff
3. Staff enters code in tablet
4. System validates:
   - Card exists
   - Not already used
   - Not expired
5. Card balance applied to order
6. If order > card value â†’ customer pays difference
7. If order < card value â†’ remaining balance stays on card
```

**Online (with e-commerce plugin):**
```
1. Customer at checkout
2. Enters gift card code
3. Balance applied automatically
4. Partial use supported
```

---

## Database Schema

```sql
-- Gift card reward type
-- (Added to existing rewards table via reward_type field)

-- Gift cards issued
CREATE TABLE gift_cards (
  id TEXT PRIMARY KEY,              -- 'gc_' prefix
  code TEXT UNIQUE NOT NULL,        -- Human-readable code (TONY-A3F7-X9K2)
  business_id TEXT NOT NULL,
  reward_id TEXT NOT NULL,          -- Which reward this came from
  customer_id TEXT NOT NULL,        -- Who earned it
  recipient_id TEXT,                -- If gifted, who received it
  original_value DECIMAL(10,2) NOT NULL,
  current_balance DECIMAL(10,2) NOT NULL,
  status TEXT DEFAULT 'active',     -- 'active', 'used', 'expired', 'cancelled'
  earned_at TIMESTAMPTZ DEFAULT NOW(),
  expires_at TIMESTAMPTZ,
  used_at TIMESTAMPTZ,
  gifted_at TIMESTAMPTZ,
  gift_message TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Gift card transactions (for partial use)
CREATE TABLE gift_card_transactions (
  id TEXT PRIMARY KEY,
  gift_card_id TEXT NOT NULL,
  transaction_type TEXT NOT NULL,   -- 'redemption', 'refund'
  amount DECIMAL(10,2) NOT NULL,
  balance_after DECIMAL(10,2) NOT NULL,
  order_reference TEXT,
  staff_id TEXT,
  location_id TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_gift_cards_code ON gift_cards(code);
CREATE INDEX idx_gift_cards_customer ON gift_cards(customer_id);
```

---

## Gift Card Configuration (Admin)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Reward: Gift Card                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ Type: [Gift Card â–¼]                                        â”‚
â”‚                                                             â”‚
â”‚ Gift Card Value: $[10.00     ]                             â”‚
â”‚ Points Cost:     [1000       ] doubloons                   â”‚
â”‚                                                             â”‚
â”‚ Options:                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [âœ“] Allow gifting to others                            â”‚ â”‚
â”‚ â”‚ [âœ“] Allow partial redemption                           â”‚ â”‚
â”‚ â”‚ [ ] Single use only (full value or nothing)            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ Expiration:                                                â”‚
â”‚ â—‹ Never expires                                            â”‚
â”‚ â— Expires after [90] days                                  â”‚
â”‚ â—‹ Expires on specific date: [____]                         â”‚
â”‚                                                             â”‚
â”‚ âš ï¸ Note: Gift card laws vary by state. Some jurisdictions  â”‚
â”‚    prohibit expiration dates on gift cards.                â”‚
â”‚                                                             â”‚
â”‚ [Save Reward]                                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Staff Tablet Interface

### Redeem Gift Card

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸŽ Redeem Gift Card                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ [Scan QR Code]  or  Enter Code:                            â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ TONY-A3F7-X9K2                                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ [Look Up]                                                  â”‚
â”‚                                                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚ âœ“ Gift Card Found                                          â”‚
â”‚                                                             â”‚
â”‚ Value:     $10.00                                          â”‚
â”‚ Balance:   $10.00                                          â”‚
â”‚ Earned by: Sarah M.                                        â”‚
â”‚ Expires:   March 30, 2025                                  â”‚
â”‚                                                             â”‚
â”‚ Order Total: $[24.50     ]                                 â”‚
â”‚                                                             â”‚
â”‚ Apply: $[10.00] (max available)                            â”‚
â”‚                                                             â”‚
â”‚ Remaining to pay: $14.50                                   â”‚
â”‚ New card balance: $0.00                                    â”‚
â”‚                                                             â”‚
â”‚ [Cancel]  [Apply Gift Card]                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Endpoints

```typescript
// Create gift card reward (admin)
POST /api/admin/rewards
{
  name: "$10 Gift Card",
  type: "gift_card",
  pointsCost: 1000,
  giftCardValue: 10.00,
  allowGifting: true,
  allowPartialUse: true,
  expirationDays: 90
}

// Redeem for gift card (customer)
POST /api/customer/rewards/:id/redeem
// Response includes gift card details
{
  giftCard: {
    id: "gc_abc123",
    code: "TONY-A3F7-X9K2",
    value: 10.00,
    expiresAt: "2025-03-30",
    qrCode: "data:image/png;base64,..."
  }
}

// Gift to friend (customer)
POST /api/customer/gift-cards/:id/gift
{
  recipientPhone: "+15559876543",
  recipientEmail: "friend@example.com",  // Optional
  message: "Enjoy dinner on me!"
}

// Look up gift card (staff)
GET /api/staff/gift-cards/lookup?code=TONY-A3F7-X9K2

// Apply gift card to order (staff)
POST /api/staff/gift-cards/:id/apply
{
  amount: 10.00,
  orderReference: "order_12345"
}
```

---

## Legal Considerations

### Gift Card Laws

Many jurisdictions have laws about gift cards:
- **No expiration:** CA, CT, ME, MA, etc. prohibit expiration
- **No fees:** Many states prohibit inactivity fees
- **Disclosure:** Must clearly state terms

### Recommendation

- Default to **no expiration** for compliance
- Allow tenant to set expiration with warning
- Clear terms displayed on gift card
- Consult legal for full compliance

---

## Implementation Plan

### Phase 1: Basic Gift Cards
- [ ] Gift card reward type
- [ ] Gift card generation
- [ ] Customer wallet view
- [ ] Staff lookup/apply interface

### Phase 2: Partial Use & Balance
- [ ] Track remaining balance
- [ ] Multiple uses per card
- [ ] Balance history

### Phase 3: Gifting
- [ ] Gift to friend flow
- [ ] Email/SMS delivery
- [ ] Recipient claiming

### Phase 4: Integration
- [ ] Apple Wallet integration
- [ ] Google Pay integration
- [ ] E-commerce plugin support

---

## Open Questions

1. **Platform gift cards?** Cards usable at any Rewards Pirate business?
2. **Cash out?** Should businesses allow cashing out points to gift cards?
3. **Third-party gift cards?** Integrate with gift card providers (Amazon, Visa)?
4. **Minimum balance?** When balance is tiny ($0.47), what happens?

---

*Last updated: January 2025*
